<?php 
	$data = stripslashes(trim($_POST["ocrData"]));
	$datapre = "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  ."% the input lines are sorted by scanned character%\r\n"
			  ."% not by test number or imprint number, because  %\r\n"
			  ."% of this, the directives are discontiguous.     %\r\n"
			  ."% it wouldn't hurt to remove the next block, but %\r\n"
			  ."% it would cause a ton of warnings.              %\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  .":- discontiguous test1/2.\r\n"
			  .":- discontiguous test2/2.\r\n"
			  .":- discontiguous test3/2.\r\n"
			  .":- discontiguous test4/2.\r\n"
			  .":- discontiguous test5/2.\r\n"
			  .":- discontiguous test6/2.\r\n"
			  .":- discontiguous test7/2.\r\n"
			  .":- discontiguous test8/2.\r\n"
			  .":- discontiguous impri/2.\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  ."% The following lines are the generated input    %\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n";
	$datapos = "\r\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  ."% The following lines are the preconfigured rules%\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  ."letterA(X) :-   test1(X,pass),\r\n"
			  ."                test2(X,pass),\r\n"
			  ."                test3(X,pass),\r\n"
			  ."                test4(X,fail),\r\n"
			  ."                test5(X,fail),\r\n"
			  ."                test6(X,fail),\r\n"
			  ."                test7(X,pass),\r\n"
			  ."                test8(X,fail),\r\n"
			  ."				impri(X,'A'),\r\n"
			  ."				write(X),write(' is A.'),nl.\r\n"
			  ."letterB(X) :-   test1(X,fail),\r\n"
			  ."                test2(X,fail),\r\n"
			  ."                test3(X,fail),\r\n"
			  ."                test4(X,fail),\r\n"
			  ."                test5(X,fail),\r\n"
			  ."                test6(X,fail),\r\n"
			  ."                test7(X,fail),\r\n"
			  ."                test8(X,fail),\r\n"
			  ."                impri(X,'B'),\r\n"
			  ."				write(X),write(' is B.'),nl.\r\n"
			  ."letterC(X) :-   test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,pass),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'C'),\r\n"
			  ."				write(X),write(' is C.'),nl.\r\n"
			  ."letterD(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'D'),\r\n"
			  ."				write(X),write(' is D.'),nl.\r\n"
			  ."letterE(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'E'),\r\n"
			  ."				write(X),write(' is E.'),nl.\r\n"
			  ."letterF(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'F'),\r\n"
			  ."				write(X),write(' is F.'),nl.\r\n"
			  ."letterG(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,pass),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'G'),\r\n"
			  ."				write(X),write(' is G.'),nl.\r\n"
			  ."letterH(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'H'),\r\n"
			  ."				write(X),write(' is H.'),nl.\r\n"
			  ."letterI(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'I'),\r\n"
			  ."				write(X),write(' is I.'),nl.\r\n"
			  ."letterJ(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'J'),\r\n"
			  ."				write(X),write(' is J.'),nl.\r\n"
			  ."letterK(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'K'),\r\n"
			  ."				write(X),write(' is K.'),nl.\r\n"
			  ."letterL(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,pass),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'L'),\r\n"
			  ."				write(X),write(' is L.'),nl.\r\n"
			  ."letterM(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'M'),\r\n"
			  ."				write(X),write(' is M.'),nl.\r\n"
			  ."letterN(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'N'),\r\n"
			  ."				write(X),write(' is N.'),nl.\r\n"
			  ."letterO(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'O'),\r\n"
			  ."				write(X),write(' is O.'),nl.\r\n"
			  ."letterP(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'P'),\r\n"
			  ."				write(X),write(' is P.'),nl.\r\n"
			  ."letterQ(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'Q'),\r\n"
			  ."				write(X),write(' is Q.'),nl.\r\n"
			  ."letterR(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'R'),\r\n"
			  ."				write(X),write(' is R.'),nl.\r\n"
			  ."letterS(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,pass),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'S'),\r\n"
			  ."				write(X),write(' is S.'),nl.\r\n"
			  ."letterT(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'T'),\r\n"
			  ."				write(X),write(' is T.'),nl.\r\n"
			  ."letterU(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'U'),\r\n"
			  ."				write(X),write(' is U.'),nl.\r\n"
			  ."letterV(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,pass),\r\n"
			  ."				impri(X,'V'),\r\n"
			  ."				write(X),write(' is V.'),nl.\r\n"
			  ."letterW(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'W'),\r\n"
			  ."				write(X),write(' is W.'),nl.\r\n"
			  ."letterX(X) :-	test1(X,pass),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'X'),\r\n"
			  ."				write(X),write(' is X.'),nl.\r\n"
			  ."letterY(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,pass),\r\n"
			  ."				test3(X,pass),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,pass),\r\n"
			  ."				test7(X,fail),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'Y'),\r\n"
			  ."				write(X),write(' is Y.'),nl.\r\n"
			  ."letterZ(X) :-	test1(X,fail),\r\n"
			  ."				test2(X,fail),\r\n"
			  ."				test3(X,fail),\r\n"
			  ."				test4(X,fail),\r\n"
			  ."				test5(X,fail),\r\n"
			  ."				test6(X,fail),\r\n"
			  ."				test7(X,pass),\r\n"
			  ."				test8(X,fail),\r\n"
			  ."				impri(X,'Z'),\r\n"
			  ."				write(X),write(' is Z.'),nl.\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  ."% The following lines are the results            %\r\n"
			  ."% They are being ran as seperate events in the   %\r\n"
			  ."% case that one of the letters fail, it doesn't  %\r\n"
			  ."% cause all letters after it to fail as well     %\r\n"
			  ."%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n"
			  .":- letterA(_).\r\n"
			  .":- letterB(_).\r\n"
			  .":- letterC(_).\r\n"
			  .":- letterD(_).\r\n"
			  .":- letterE(_).\r\n"
			  .":- letterF(_).\r\n"
			  .":- letterG(_).\r\n"
			  .":- letterH(_).\r\n"
			  .":- letterI(_).\r\n"
			  .":- letterJ(_).\r\n"
			  .":- letterK(_).\r\n"
			  .":- letterL(_).\r\n"
			  .":- letterM(_).\r\n"
			  .":- letterN(_).\r\n"
			  .":- letterO(_).\r\n"
			  .":- letterP(_).\r\n"
			  .":- letterQ(_).\r\n"
			  .":- letterR(_).\r\n"
			  .":- letterS(_).\r\n"
			  .":- letterT(_).\r\n"
			  .":- letterU(_).\r\n"
			  .":- letterV(_).\r\n"
			  .":- letterW(_).\r\n"
			  .":- letterX(_).\r\n"
			  .":- letterY(_).\r\n"
			  .":- letterZ(_).\r\n";
  if($data == ""){             
    echo "Data was not received"; 
  }else{
    echo "<a href='results.pro'>Data was successfully written, right click this and save to disk.</a>";
	$File = "results.pro"; 
	$Handle = fopen($File, 'w'); 
	fwrite($Handle, $datapre.$data.$datapos);    
	fclose($Handle); 
  }
?>