<!doctype html><head><title>VBA Indenter</title>
<link href='VBCompiler.css' rel='stylesheet'></link></head>
<body><div id='result'>Loading Content...</div>
<script src='input.bas' type='text/visualbasic'></script>
<script src='VBCompiler.js'></script>
<script>
var entityMap ={
	'<':'&lt;',
	'>':'&gt;'
};
var isNumber={
	'1':1,'2':1,'3':1,'4':1,'5':1,'6':1,'7':1,'8':1,'9':1,'0':1
};
var isLetter={
	'a':1,'b':1,'c':1,'d':1,'e':1,'f':1,'g':1,'h':1,'i':1,'j':1,'h':1,'i':1,'j':1,'k':1,'l':1,'m':1,'n':1,'o':1,'p':1,'q':1,'r':1,'s':1,'t':1,'u':1,'v':1,'w':1,'x':1,'y':1,'z':1
};
var unreservedKeywords={
	'Aggregate':{},
	'Ansi':{},
	'Assembly':{},
	'Auto':{},
	'Binary':{},
	'Compare':{},
	'Custom':{},
	'Distinct':{},
	'Equals':{},
	'Explicit':{},
	'From':{},
	'Group':{},
	'By':{},
	'Join':{},
	'Key':{},
	'Mid':{},
	'Off':{},
	'Order':{},
	'Preserve':{},
	'Skip':{},
	'Strict':{},
	'Take':{},
	'Text':{},
	'Unicode':{},
	'Until':{},
	'Where':{},
	'#ExternalSource':{},
	'#Region':{}
};
var vbaAdditionalKeywords={
	'Abs':{},
	'Activate':{},
	'ActiveCell':{},
	'ActiveSheet':{},
	'Address':{},
	'Application':{},
	'Array':{},
	'Asc':{},
	'Atn':{},
	'Bold':{},
	'Cells':{},
	'Characters':{},
	'Clear':{},
	'Close':{},
	'Column':{},
	'ColumnWidth':{},
	'ConvertFormula':{},
	'Copy':{},
	'Cos':{},
	'Count':{},
	'Cut':{},
	'CVErr':{},
	'Declare':{dTab:1},
	'Delete':{},
	'Err':{},
	'Evaluate':{},
	'Exp':{},
	'FillDown':{},
	'FillRight':{},
	'Fix':{},
	'Font':{},
	'FontStyle':{},
	'Format':{},
	'Formula':{},
	'InputBox':{},
	'Insert':{},
	'Instr':{},
	'Int':{},
	'Intersect':{},
	'IsArray':{},
	'IsDate':{},
	'IsEmpty':{},
	'IsMissing':{},
	'IsNull':{},
	'IsNumeric':{},
	'Italic':{},
	'LBound':{},
	'LCase':{},
	'LTrim':{},
	'Left':{},
	'Len':{},
	'Log':{},
	'MacroOptions':{},
	'Mid':{},
	'Mod':{},
	'MsgBox':{},
	'Name':{},
	'Now':{},
	'NumberFormat':{},
	'Open':{},
	'Base':{},
	'Explicit':{},
	'Keyword':{},
	'Paste':{},
	'Preserve':{},
	'Quit':{},
	'Right':{},
	'Rnd':{},
	'Row':{},
	'RowHeight':{},
	'Rows':{},
	'RTrim':{},
	'Save':{},
	'SaveAs':{},
	'Selection':{},
	'Sgn':{},
	'Sin':{},
	'Sort':{},
	'Sqr':{},
	'Str':{},
	'Tan':{},
	'Text':{},
	'Trim':{},
	'Ubound':{},
	'UCase':{},
	'Union':{},
	'Until':{},
	'Val':{},
	'Value':{},
	'Variant':{},
	'Wend':{},
	'Wend':{},
	'XOr':{}
};
var reservedKeywords={
	'AddHandler':{},
	'AddressOf':{},
	'Alias':{},
	'And':{},
	'AndAlso':{},
	'As':{},
	'Boolean':{},
	'ByRef':{},
	'Byte':{},
	'ByVal':{},
	'Call':{},
	'Case':{dTab:1},
	'Catch':{},
	'CBool':{},
	'CByte':{},
	'CChar':{},
	'CDate':{},
	'CDec':{},
	'CDbl':{},
	'Char':{},
	'CInt':{},
	'Class':{},
	'Clng':{},
	'CObj':{},
	'Const':{},
	'Continue':{},
	'CSByte':{},
	'CShort':{},
	'CSng':{},
	'CStr':{},
	'CType':{},
	'CUint':{},
	'CUlng':{},
	'CUShort':{},
	'Date':{},
	'Decimal':{},
	'Declare':{},
	'Default':{},
	'Delegate':{},
	'Dim':{},
	'DirectCast':{},
	'Do':{tab:1,dTab:1},
	'Double':{},
	'Each':{},
	'Else':{nTab:-1},
	'ElseIf':{nTab:-1},
	'End':{rTab:1},
	'EndIf':{},
	'Enum':{},
	'Erase':{},
	'Error':{},
	'Event':{},
	'Exit':{dTab:1},
	'False':{},
	'Finally':{},
	'For':{tab:1},
	'Friend':{},
	'Function':{tab:1},
	'Get':{},
	'GetType':{},
	'GetXMLNamespace':{},
	'Global':{},
	'GoSub':{},
	'GoTo':{},
	'Handles':{},
	'If':{tab:1},
	'Imports':{},
	'In':{},
	'Inherits':{},
	'Integer':{},
	'Interface':{},
	'Is':{},
	'IsNot':{},
	'Let':{},
	'Lib':{},
	'Like':{},
	'Long':{},
	'Loop':{iTab:-1},
	'Me':{},
	'Mod':{},
	'Module':{},
	'MustInherit':{},
	'MustOverride':{},
	'MyBase':{},
	'MyClass':{},
	'Namespace':{},
	'Narrowing':{},
	'New':{},
	'Next':{iTab:-1},
	'Not':{},
	'Nothing':{},
	'NotInheritable':{},
	'NotOverridable':{},
	'Object':{},
	'Of':{},
	'On':{dTab:1},
	'Operator':{},
	'Option':{},
	'Optional':{},
	'Or':{},
	'OrElse':{},
	'Overloads':{},
	'Overridable':{},
	'Overrides':{},
	'ParamArray':{},
	'Partial':{},
	'Private':{},
	'Property':{},
	'Protected':{},
	'Public':{},
	'RaiseEvent':{},
	'ReadOnly':{},
	'ReDim':{},
	'REM':{},
	'RemoveHandler':{},
	'Resume':{dTab:1},
	'Return':{},
	'SByte':{},
	'Select':{tab:1,dTab:1},
	'Set':{},
	'Shadows':{},
	'Shared':{},
	'Short':{},
	'Single':{},
	'Static':{},
	'Step':{},
	'Stop':{},
	'String':{},
	'Structure':{},
	'Sub':{tab:1},
	'SyncLock':{},
	'Then':{},
	'Throw':{},
	'To':{},
	'True':{},
	'Try':{},
	'TryCast':{},
	'TypeOf':{},
	'Variant':{},
	'Wend':{},
	'UInteger':{},
	'ULong':{},
	'UShort':{},
	'Using':{},
	'When':{},
	'While':{tab:1},
	'Widening':{},
	'With':{tab:1},
	'WithEvents':{},
	'WriteOnly':{},
	'Xor':{},
	'#Const':{},
	'#Else':{},
	'#ElseIf':{},
	'#End':{},
	'#If':{}
};
var operators={
	'=':{},
	'&':{},
	'&=':{},
	'*':{},
	'*=':{},
	'/':{},
	'/=':{},
	'\\':{},
	'\\=':{},
	'^':{},
	'^=':{},
	'+':{},
	'+=':{},
	'-':{},
	'-=':{},
	'&gt;&gt;':{},
	'&gt;&gt;=':{},
	'&lt;&lt;':{},
	'&lt;&lt;=':{},
	'&gt;':{},
	'&lt;':{},
	'&lt;&gt;':{},
	'(':{},
	')':{}
};
var escapeHtml=function(o){
	return String(o).replace(/[<>]/g,function(s){return entityMap[s];});
};
var checkDone=function(){
	if(typeof VB == 'undefined'){
		setTimeout("checkDone()",10);
	}else{
		compile(escapeHtml(VB).replace(/\n\r\r/g,'\r').replace(/\(/g,' ( ').replace(/\)/g,' ) ').split('\r'));
	} //end if
};
var compile=function(data){
	//Instantiate the output window
	var result=document.getElementById('result');
	var output='',oLine='';
	var comment=0,instring=0,w,tw,i,tabsc=0,tabs=0,dTab=0,then=0;
	var conditions=function(){return !comment&&!instring;};
	var addTabs=function(){
		for(var i=0;i<tabsc;i++){
			output+="&nbsp;&nbsp;&nbsp;&nbsp;";
		} //end for
		tabsc=tabs;
	};
	//Main block
	for(line in data){
		oLine='';
		data[line]=data[line].split(' ');
		for(word in data[line]){
			w=data[line][word];
			if(!instring&&!comment&&w.trim()[0]=="'"){
				comment=1;oLine+='<span style="color:#0F0;">';
			}else if(!comment&&w.indexOf('"')>-1){ //comment 1+ string is inside the word
				tw='';
				for(i=0;i<w.length;i++){
					if(w[i]=='"'){
						if(!instring){
							tw+='<span style="color:#A95;">"'
						}else{
							tw+='"</span>';
						} //end if
						instring^=1;
					}else{
						tw+=w[i];
					} //end if
				} //end for
				w=tw;
			} //end if
			if(conditions()&&operators[w]){
				oLine+='<span style="color:#FF0">'+w+'</span> ';
			}else if(conditions()&&vbaAdditionalKeywords[w.trim()]){
				if(vbaAdditionalKeywords[w.trim()].tab&&!dTab)tabs+=vbaAdditionalKeywords[w.trim()].tab;
				if(vbaAdditionalKeywords[w.trim()].dTab)dTab=1;
				if(vbaAdditionalKeywords[w.trim()].iTab&&!dTab)tabs=tabsc+=vbaAdditionalKeywords[w.trim()].iTab;
				if(vbaAdditionalKeywords[w.trim()].rTab&&!dTab)tabs=tabsc---2;
				if(vbaAdditionalKeywords[w.trim()].nTab&&!dTab)tabsc+=vbaAdditionalKeywords[w.trim()].nTab;
				oLine+='<span style="color:#49F">'+w+'</span> ';
			}else if(conditions()&&reservedKeywords[w.trim()]){
				if(reservedKeywords[w.trim()].tab&&!dTab)tabs+=reservedKeywords[w.trim()].tab;
				if(reservedKeywords[w.trim()].dTab)dTab=1;
				if(reservedKeywords[w.trim()].iTab&&!dTab)tabs=tabsc+=reservedKeywords[w.trim()].iTab;
				if(reservedKeywords[w.trim()].rTab&&!dTab)tabs=tabsc---2;
				if(reservedKeywords[w.trim()].nTab&&!dTab)tabsc+=reservedKeywords[w.trim()].nTab;
				if(w.trim()=='Then')then=1;
				oLine+='<span style="color:#94F">'+w+'</span> ';
			}else{
				oLine+=w+' ';
				if(then&&!comment&&w.trim()!=''){tabs--;then=0;}
			} //end if
		} //end for
		if(comment){
			oLine+='</span>';
			comment=0;
		}
		addTabs();
		output+=oLine+'<br/>';
		dTab=0;then=0;
	} //end for
	//Display the results
	result.innerHTML=output;
	result.style.visibility='visible';
};
(function(){
	checkDone();
})();
</script></body></html>