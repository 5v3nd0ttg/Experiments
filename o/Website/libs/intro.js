var smokeImage = new Image();
smokeImage.src = "imgs/smokeParticle.png";
var scene = new Ion(250);
scene.sx = function () {return r(0, v.w);};
scene.sy = function () {return r(0, v.h / 2) + v.h / 8 * 3;};
scene.dx = function () {return v.w;};
scene.dy = function () {return r(0, v.h / 2) + v.h / 8 * 3;};
scene.wx = function () {return r(0, 3) - 1.5;};
scene.wy = function () {return r(0, 1) - 0.5;};
scene.size = function () {return r(1, 3);};
scene.tween_type = 17;
scene.tween_speed = 40;
scene.image = smokeImage;
scene.imageWidth = 256;
scene.imageHeight = 256;
scene.onEscape = function (id) {this.onEnd(id);};
scene.onEnd = function (id) {
  this.particle[id].x = this.particle[id].sx = r(0, v.w);
  this.particle[id].y = this.particle[id].sy = r(0, v.h / 2) + v.h / 8 * 3;
  //this.particle[id].dx = v.w;
  //this.particle[id].dy = r(v.h/4)+ v.h/4;
  this.particle[id].c = 0;
};
scene.retain = function () {
  ctx.save();
  ctx.scale(0.75, 1);
  ctx.beginPath();
  ctx.arc(v.w/4*3, v.h/2, 30, 0, 2*Math.PI, false);
  ctx.fillStyle='gray';
  ctx.fill();
  ctx.fillRect(v.w/4*3-20, v.h/2, 40,100);
  ctx.fillRect(v.w/4*3-40, v.h/2+30,20,50);
  ctx.fillRect(v.w/4*3+20, v.h/2+30,20,50);
  ctx.fillRect(v.w/4*3-30, v.h/2+100,20,100);
  ctx.fillRect(v.w/4*3+10, v.h/2+100,20,100);
  ctx.closePath();
  ctx.restore();

  ctx.beginPath();
  ctx.arc(v.w/2, v.h/8*7,25,0,2*Math.PI,false);
  ctx.fillStyle='green';
  ctx.fill();
};
scene.populate();
scene.process();