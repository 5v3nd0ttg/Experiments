<!doctype html>
<head><title>Map Generation</title></head>
<body style='background-color:#000'>
<div id='frame' style='position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;'>
	<canvas id='canvas'>Your browser doesn't support canvas.</canvas>
</div>
<script>
var $=function(o){return document.getElementById(o);};
var v=(function(){var e=window,a='inner';if(!('innerWidth' in window)){a='client';e=document.documentElement||document.body;}return {w:e[a+'Width'],h:e[a+'Height']};})();
var r=function(n,m){return Math.random()*n|0+(m||0);};
var ctx=$('canvas').getContext("2d");
		$('canvas').setAttribute("width",v.w+'px');
		$('canvas').setAttribute("height",v.h+'px');
var sector=function(x,y){
	this.wall=Math.random()<0.25?1:0;
	this.floor=Math.random()<0.90?1:0;
	if(this.floor==0){
		(function(){
			var startColor=100+r(105);
			water.push({x:x,y:y,cur:startColor,max:startColor,dir:r(2)});
		})();
	} //end if
};
var water=[];
var map={
	width:30,
	height:25,
	sector:[],
	generate:function(){
		for(var i=0;i<map.width;i++){
			map.sector[i]=[];
			for(var j=0;j<map.height;j++){
				map.sector[i][j]=new sector(i,j);
			} //end for
		} //end for
	}, //end generate()
	draw:function(){
		for(var i=0;i<map.width;i++){
			for(var j=0;j<map.height;j++){
				if(map.sector[i][j].wall){ctx.fillStyle="#333";
				}else if(map.sector[i][j].floor){ctx.fillStyle="#0"+r(4,6)+"0";
				}else{ctx.fillStyle="#00F";}
				ctx.fillRect(i*v.w/map.width,j*v.h/map.height,v.w/map.width+1,v.h/map.height+1);
				if(map.sector[i][j].wall){
					ctx.fillStyle="#888";
					ctx.fillRect(i*v.w/map.width+v.w/map.width*.1,j*v.h/map.height+v.h/map.height*.1,v.w/map.width*.8,v.h/map.height*.8);
				} //end if
			} //end for
		} //end for
	} //end draw()
}; //end map
(function(){
	map.generate();
	map.draw();
	setInterval(function(){
		for(var i=0;i<water.length;i++){
			if(water[i].dir==0){water[i].cur--;}else{water[i].cur++;}
			if(water[i].max-50==water[i].cur||water[i].max+50==water[i].cur)water[i].dir^=1;
			ctx.fillStyle="rgb(0,0,"+water[i].cur+')';
			ctx.fillRect(water[i].x*v.w/map.width,water[i].y*v.h/map.height,v.w/map.width+1,v.h/map.height+1);
		} //end for
	},10);
})();
</script>
</body></html>