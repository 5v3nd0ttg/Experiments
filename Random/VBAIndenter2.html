<!doctype html><head><title>VBA Indenter</title></head><style>
body{
	background-color:#111;
}
textarea{position:absolute;
	     left:0;top:0;
	     width:100%;height:100%;
	     background-color:#111;
	     color:#999;
	     border:0;padding:0;margin:0;
	     font-family:'Courier New';
	     font-size:1em;
	     font-weight:800;
}
div{
	position:absolute;
	left:0;top:0;bottom:0;right:0;
	visibility:hidden;
	color:#999;
	scroll-y:true;
	font-family:'Courier New';
	font-size:1em;
	font-weight:800;
}
</style><body><textarea id='content'></textarea>
<div id='result'></div><script>
var contentArea=document.getElementById('content');
var entityMap ={
	'<':'&lt;',
	'>':'&gt;'
};
var isNumber={
	'1':1,'2':1,'3':1,'4':1,'5':1,'6':1,'7':1,'8':1,'9':1,'0':1
};
var isLetter={
	'a':1,'b':1,'c':1,'d':1,'e':1,'f':1,'g':1,'h':1,'i':1,'j':1,'h':1,'i':1,'j':1,'k':1,'l':1,'m':1,'n':1,'o':1,'p':1,'q':1,'r':1,'s':1,'t':1,'u':1,'v':1,'w':1,'x':1,'y':1,'z':1
};
var unreservedKeywords={
	'Aggregate':{},
	'Ansi':{},
	'Assembly':{},
	'Auto':{},
	'Binary':{},
	'Compare':{},
	'Custom':{},
	'Distinct':{},
	'Equals':{},
	'Explicit':{},
	'From':{},
	'Group':{},
	'By':{},
	'Join':{},
	'Key':{},
	'Mid':{},
	'Off':{},
	'Order':{},
	'Preserve':{},
	'Skip':{},
	'Strict':{},
	'Take':{},
	'Text':{},
	'Unicode':{},
	'Until':{},
	'Where':{},
	'#ExternalSource':{},
	'#Region':{}
};
var vbaAdditionalKeywords={
	'Abs','Activate','ActiveCell','ActiveSheet','Address','Application','Array','As','Asc','Atn','Bold','Boolean','Call','Case','Cells','Characters','Clear','Close','Column','ColumnWidth','ConvertFormula','Copy','Cos','Count','Cut','CVErr','Delete','Dim','Do','Loop','Double','Else','ElseIf','End','EndIf','Err','Evaluate','Exit','Exp','False','FillDown','FillRight','Fix','Font','FontStyle','For','Next','Step','Each','Format','Formula','Function','GoTo','Then','InputBox','Insert','Instr','Int','Integer','Intersect','IsArray','IsDate','IsEmpty','IsMissing','IsNull','IsNumeric','Italic','LBound','LCase','LTrim','Left','Len','Log','MacroOptions','Mid','Mod','MsgBox','Name','Next','Now','NumberFormat','On','Open','Option','Base','Explicit','Optional','Keyword','ParamArray','Paste','Preserve','Private','Public','Quit','ReDim','Resume','Return','Right','Rnd','Row','RowHeight','Rows','RTrim','Save','SaveAs','Select','Selection','Set','Sgn','Sin','Sort','Sqr','Step','Str','String','Sub','Tan','Text','Trim','True','Ubound','UCase','Union','Until','Val','Value','Variant','Wend','While','Wend','XOr'
}
var reservedKeywords={
	'AddHandler':{},
	'AddressOf':{},
	'Alias':{},
	'And':{},
	'AndAlso':{},
	'As':{},
	'Boolean':{},
	'ByRef':{},
	'Byte':{},
	'ByVal':{},
	'Call':{},
	'Case':{},
	'Catch':{},
	'CBool':{},
	'CByte':{},
	'CChar':{},
	'CDate':{},
	'CDec':{},
	'CDbl':{},
	'Char':{},
	'CInt':{},
	'Class':{},
	'Clng':{},
	'CObj':{},
	'Const':{},
	'Continue':{},
	'CSByte':{},
	'CShort':{},
	'CSng':{},
	'CStr':{},
	'CType':{},
	'CUint':{},
	'CUlng':{},
	'CUShort':{},
	'Date':{},
	'Decimal':{},
	'Declare':{},
	'Default':{},
	'Delegate':{},
	'Dim':{},
	'DirectCast':{},
	'Do':{},
	'Double':{},
	'Each':{},
	'Else':{},
	'ElseIf':{},
	'End':{},
	'EndIf':{},
	'Enum':{},
	'Erase':{},
	'Error':{},
	'Event':{},
	'Exit':{},
	'False':{},
	'Finally':{},
	'For':{},
	'Friend':{},
	'Function':{},
	'Get':{},
	'GetType':{},
	'GetXMLNamespace':{},
	'Global':{},
	'GoSub':{},
	'GoTo':{},
	'Handles':{},
	'Imports':{},
	'In':{},
	'Inherits':{},
	'Integer':{},
	'Interface':{},
	'Is':{},
	'IsNot':{},
	'Let':{},
	'Lib':{},
	'Like':{},
	'Long':{},
	'Loop':{},
	'Me':{},
	'Mod':{},
	'Module':{},
	'MustInherit':{},
	'MustOverride':{},
	'MyBase':{},
	'MyClass':{},
	'Namespace':{},
	'Narrowing':{},
	'New':{},
	'Next':{},
	'Not':{},
	'Nothing':{},
	'NotInheritable':{},
	'NotOverridable':{},
	'Object':{},
	'Of':{},
	'On':{},
	'Operator':{},
	'Option':{},
	'Optional':{},
	'Or':{},
	'OrElse':{},
	'Overloads':{},
	'Overridable':{},
	'Overrides':{},
	'ParamArray':{},
	'Partial':{},
	'Private':{},
	'Property':{},
	'Protected':{},
	'Public':{},
	'RaiseEvent':{},
	'ReadOnly':{},
	'ReDim':{},
	'REM':{},
	'RemoveHandler':{},
	'Resume':{},
	'Return':{},
	'SByte':{},
	'Select':{},
	'Set':{},
	'Shadows':{},
	'Shared':{},
	'Short':{},
	'Single':{},
	'Static':{},
	'Step':{},
	'Stop':{},
	'String':{},
	'Structure':{},
	'Sub':{},
	'SyncLock':{},
	'Then':{},
	'Throw':{},
	'To':{},
	'True':{},
	'Try':{},
	'TryCast':{},
	'TypeOf':{},
	'Variant':{},
	'Wend':{},
	'UInteger':{},
	'ULong':{},
	'UShort':{},
	'Using':{},
	'When':{},
	'While':{},
	'Widening':{},
	'With':{},
	'WithEvents':{},
	'WriteOnly':{},
	'Xor':{},
	'#Const':{},
	'#Else':{},
	'#ElseIf':{},
	'#End':{},
	'#If':{}
};
var operators={
	'=':{},
	'&':{},
	'&=':{},
	'*':{},
	'*=':{},
	'/':{},
	'/=':{},
	'\\':{},
	'\\=':{},
	'^':{},
	'^=':{},
	'+':{},
	'+=':{},
	'-':{},
	'-=':{},
	'>>':{},
	'>>=':{},
	'<<':{},
	'<<=':{}
};
var escapeHtml=function(o){
	return String(o).replace(/[<>]/g,function(s){return entityMap[s];});
};
contentArea.onkeydown=function(e){
	var data='';
	if(!e){
		document.getElementById('content').innerHTML="Your browser is too old, or you're emulating an old browser. Please update";
	}else if(e.key=="Enter"){
		data=contentArea.innerHTML;
		data=escapeHtml(data);
		compile(data);
	} //end if
};

var compile=function(olddata){
	var newdata='',tabOrder=0,comment=false,string=false,then=false,length,dotOperator=false,notNumber=false;
	for(var i=0;i<olddata.length;i++){
		if(!comment && !string && !dotOperator && olddata[i]==' '){notNumber=false;continue;}
		if(!comment && !string && olddata[i]=='_'){
			if(i>0&&olddata[i-1]==' '||i===0){ //variable names can't start with a _ so it must be a line return
				i++;
				continue;
			} //end if
		} //end if
		if(olddata[i]=='\n'||olddata[i]=='\r'){
			newdata+="<br/>";then=false;length=i;dotOperator=false;notNumber=false;
			if(string){string=false;newdata+="</span>";}
			if(comment){comment=false;newdata+="</span>";}
			for(var j=0;j<tabOrder;j++){
				newdata+='&nbsp;&nbsp;&nbsp;&nbsp;'; //4 space tabs
			}
			for(j=i+1;j<olddata.length;j++){
				if(olddata[j]=='\n'||olddata[j]=='\r'||olddata[j]==' '){
					i++;
				}else{
					break;
				} //end if
			}
		}else if(!string && !comment && olddata[i]=='O' && i+23<olddata.length && olddata.substring(i,i+23)=='Option Compare Database'){
			newdata+="<span style='color:#F53'>Option Compare Database</span>";i+=22;
		}else if(!string && !comment && olddata[i]=='O' && i+15<olddata.length && olddata.substring(i,i+15)=='Option Explicit'){
			newdata+="<span style='color:#F53'>Option Explicit</span>";i+=14;
		}else if(!string && !comment && olddata[i]=='P' && i+25<olddata.length && olddata.substring(i,i+25)=='Private Declare Function '){
			newdata+="<span style='color:#FF5'>Private Declare Function </span>";i+=24;
		}else if(!string && !comment && olddata[i]=='P' && i+24<olddata.length && olddata.substring(i,i+24)=='Public Declare Function '){
			newdata+="<span style='color:#FF5'>Public Declare Function </span>";i+=23;
		}else if(!string && !comment && olddata[i]=='D' && i+17<olddata.length && olddata.substring(i,i+17)=='Declare Function '){
			newdata+="<span style='color:#F9F'>Declare Function </span>";i+=16;
		}else if(!string && !comment && olddata[i]=='P' && i+17<olddata.length && olddata.substring(i,i+17)=='Private Function '){
			newdata+="&nbsp;<br/><span style='color:#99F'>Private Function </span>";i+=16;tabOrder++;
		}else if(!string && !comment && olddata[i]=='P' && i+16<olddata.length && olddata.substring(i,i+16)=='Public Function '){
			newdata+="&nbsp;<br/><span style='color:#99F'>Public Function </span>";i+=15;tabOrder++;
		}else if(!string && !comment && olddata[i]=='G' && i+13<olddata.length && olddata.substring(i,i+13)=='Global Const '){
			newdata+="<span style='color:#FFF'>Global Const </span>";i+=12;
		}else if(!string && !comment && olddata[i]=='G' && i+7<olddata.length && olddata.substring(i,i+7)=='Global '){
			newdata+="<span style='color:#FFF'>Global </span>";i+=6;
		}else if(!string && !comment && olddata[i]=='C' && i+6<olddata.length && olddata.substring(i,i+6)=='Const '){
			newdata+="<span style='color:#FFF'>Const </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='P' && i+13<olddata.length && olddata.substring(i,i+13)=='Public Const '){
			newdata+="<span style='color:#FFF'>Public Const </span>";i+=12;
		}else if(!string && !comment && olddata[i]=='P' && i+12<olddata.length && olddata.substring(i,i+12)=='Private Sub '){
			newdata+="&nbsp;<br/><span style='color:#9FF'>Private Sub </span>";i+=11;tabOrder++;
		}else if(!string && !comment && olddata[i]=='P' && i+11<olddata.length && olddata.substring(i,i+11)=='Public Sub '){
			newdata+="&nbsp;<br/><span style='color:#9FF'>Public Sub </span>";i+=10;tabOrder++;
		}else if(!string && !comment && olddata[i]=='P' && i+7<olddata.length && olddata.substring(i,i+7)=='Public '){
			newdata+="<span style='color:#9FF'>Public </span>";i+=6;
		}else if(!string && !comment && olddata[i]=='P' && i+8<olddata.length && olddata.substring(i,i+8)=='Private '){
			newdata+="<span style='color:#9FF'>Private </span>";i+=7;
		}else if(!string && !comment && olddata[i]=='F' && i+9<olddata.length && olddata.substring(i,i+9)=='Function '){
			newdata+="&nbsp;<br/><span style='color:#99F'>Function </span>";i+=8;tabOrder++;
		}else if(!string && !comment && olddata[i]=='S' && i+4<olddata.length && olddata.substring(i,i+4)=='Sub '){
			newdata+="&nbsp;<br/><span style='color:#99F'>Sub </span>";i+=3;tabOrder++;
		}else if(!string && !comment && olddata[i]=='E' && i+13<olddata.length && olddata.substring(i,i+13)=='Exit Function'){
			newdata+="<span style='color:#99F'>Exit Function</span>";i+=12;
		}else if(!string && !comment && olddata[i]=='E' && i+8<olddata.length && olddata.substring(i,i+8)=='Exit For'){
			newdata+="<span style='color:#0FF'>Exit For</span>";i+=7;
		}else if(!string && !comment && olddata[i]=='E' && i+7<olddata.length && olddata.substring(i,i+7)=='Exit Do'){
			newdata+="<span style='color:#0FF'>Exit Do</span>";i+=6;
		}else if(!string && !comment && olddata[i]=='E' && i+8<olddata.length && olddata.substring(i,i+8)=='Exit Sub'){
			newdata+="<span style='color:#0FF'>Exit Sub</span>";i+=7;
		}else if(!string && !comment && olddata[i]=='T' && i+17<olddata.length && olddata.substring(i,i+17)=='TransferDatabase '){
			newdata+="<span style='color:#0FF'>TransferDatabase </span>";i+=16;
		}else if(!string && !comment && olddata[i]=='E' && i+12<olddata.length && olddata.substring(i,i+12)=='End Function'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#99F'>End Function</span>";i+=11;tabOrder--;
		}else if(!string && !comment && olddata[i]=='E' && i+7<olddata.length && olddata.substring(i,i+7)=='End Sub'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#9FF'>End Sub</span>";i+=6;tabOrder--;
		}else if(!string && !comment && olddata[i]=='I' && i+3<olddata.length && olddata.substring(i,i+3)=='If '){
			newdata+="<span style='color:#0FF'>If </span>";i+=2;tabOrder++;
		}else if(!string && !comment && olddata[i]=='N' && i+4<olddata.length && olddata.substring(i,i+4)=='New '){
			newdata+="<span style='color:#0FF'>New </span>";i+=3;
		}else if(!string && !comment && olddata[i]=='E' && i+6<olddata.length && olddata.substring(i,i+6)=='End If'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>End If</span>";i+=5;tabOrder--;
		}else if(!string && !comment && olddata[i]=='E' && i+8<olddata.length && olddata.substring(i,i+8)=='End With'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>End With</span>";i+=7;tabOrder--;
		}else if(!string && !comment && olddata[i]=='W' && i+4<olddata.length && olddata.substring(i,i+4)=='Wend'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Wend</span>";i+=3;tabOrder--;
		}else if(!string && !comment && olddata[i]=='E' && i+7<olddata.length && olddata.substring(i,i+7)=='ElseIf '){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>ElseIf </span>";i+=6;
		}else if(!string && !comment && olddata[i]=='E' && i+4<olddata.length && olddata.substring(i,i+4)=='Else'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Else</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='C' && i+5<olddata.length && olddata.substring(i,i+5)=='Case '){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Case </span>";i+=4;
		}else if(!string && !comment && olddata[i]=='L' && i+11<olddata.length && olddata.substring(i,i+11)=='Loop Until '){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Loop Until </span>";i+=10;tabOrder--;
		}else if(!string && !comment && olddata[i]=='L' && i+4<olddata.length && olddata.substring(i,i+4)=='Loop'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Loop</span>";i+=3;tabOrder--;
		}else if(!string && !comment && olddata[i]=='N' && i+4<olddata.length && olddata.substring(i,i+4)=='Next'){
			newdata=newdata.substring(0,newdata.length-24);
			newdata+="<span style='color:#0FF'>Next </span>";i+=3;tabOrder--;
		}else if(!string && !comment && olddata[i]=='E' && i+10<olddata.length && olddata.substring(i,i+10)=='End Select'){
			newdata=newdata.substring(0,newdata.length-48);
			newdata+="<span style='color:#0FF'>End Select</span>";i+=9;tabOrder-=2;
		}else if(!string && !comment && olddata[i]=='O' && i+14<olddata.length && olddata.substring(i,i+14)=='On Error GoTo '){
			newdata+="<span style='color:#0FF'>On Error Goto </span>";i+=13;
		}else if(!string && !comment && olddata[i]=='O' && i+20<olddata.length && olddata.substring(i,i+20)=='On Error Resume Next'){
			newdata+="<span style='color:#0FF'>On Error Resume Next </span>";i+=19;
		}else if(!string && !comment && olddata[i]=='D' && i+5<olddata.length && olddata.substring(i,i+5)=='DoCmd'){
			newdata+="<span style='color:#0FF'>DoCmd</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='D' && i+4<olddata.length && olddata.substring(i,i+4)=='Dim '){
			if(!tabOrder){
				newdata+="<span style='color:#0FF'>Private </span>";i+=3;
			}else{
				newdata+="<span style='color:#0FF'>Dim </span>";i+=3;
			} //end if
		}else if(!string && !comment && olddata[i]=='R' && i+6<olddata.length && olddata.substring(i,i+6)=='ReDim ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>ReDim </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='P' && i+9<olddata.length && olddata.substring(i,i+9)=='Preserve ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Preserve </span>";i+=8;
		}else if(!string && !comment && olddata[i]=='O' && i+5<olddata.length && olddata.substring(i,i+5)=='Open ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Open </span>";i+=4;
		}else if(!string && !comment && olddata[i]=='R' && i+11<olddata.length && olddata.substring(i,i+11)=='Resume Next' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Resume Next</span>";i+=10;
		}else if(!string && !comment && olddata[i]=='R' && i+7<olddata.length && olddata.substring(i,i+7)=='Resume ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Resume </span>";i+=6;
		}else if(!string && !comment && olddata[i]=='A' && i+6<olddata.length && olddata.substring(i,i+6)=='Alias ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Alias </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='B' && i+6<olddata.length && olddata.substring(i,i+6)=='ByRef ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> ByRef </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='B' && i+6<olddata.length && olddata.substring(i,i+6)=='ByVal ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> ByVal </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='L' && i+4<olddata.length && olddata.substring(i,i+4)=='Lib ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Lib </span>";i+=3;
		}else if(!string && !comment && olddata[i]=='T' && i+4<olddata.length && olddata.substring(i,i+4)=='Then' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Then </span>";i+=3;then=true;
		}else if(!string && !comment && olddata[i]=='T' && i+3<olddata.length && olddata.substring(i,i+3)=='To ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> To </span>";i+=2;
		}else if(!string && !comment && olddata[i]=='M' && i+4<olddata.length && olddata.substring(i,i+4)=='Mod ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Mod </span>";i+=3;
		}else if(!string && !comment && olddata[i]=='S' && i+5<olddata.length && olddata.substring(i,i+5)=='Step ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Step </span>";i+=4;
		}else if(!string && !comment && olddata[i]=='I' && i+3<olddata.length && olddata.substring(i,i+3)=='In ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> In </span>";i+=2;
		}else if(!string && !comment && olddata[i]=='O' && i+3<olddata.length && olddata.substring(i,i+3)=='Or ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> Or </span>";i+=2;
		}else if(!string && !comment && olddata[i]=='A' && i+4<olddata.length && olddata.substring(i,i+4)=='And ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> And </span>";i+=3;
		}else if(!string && !comment && olddata[i]=='A' && i+3<olddata.length && olddata.substring(i,i+3)=='As ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> As </span>";i+=2;
		}else if(!string && !comment && olddata[i]=='S' && i+4<olddata.length && olddata.substring(i,i+4)=='Set ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Set </span>";i+=3;
		}else if(!string && !comment && olddata[i]=='W' && i+5<olddata.length && olddata.substring(i,i+5)=='With ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>With </span>";i+=4;tabOrder++;
		}else if(!string && !comment && olddata[i]=='F' && i+9<olddata.length && olddata.substring(i,i+9)=='For Each ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>For Each </span>";i+=8;tabOrder++;
		}else if(!string && !comment && olddata[i]=='F' && i+4<olddata.length && olddata.substring(i,i+4)=='For ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'> For </span>";i+=3;tabOrder++;
		}else if(!string && !comment && olddata[i]=='W' && i+6<olddata.length && olddata.substring(i,i+6)=='While ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>While </span>";i+=5;tabOrder++;
		}else if(!string && !comment && olddata[i]=='D' && i+9<olddata.length && olddata.substring(i,i+9)=='Do Until ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Do Until </span>";i+=8;tabOrder++;
		}else if(!string && !comment && olddata[i]=='D' && i+9<olddata.length && olddata.substring(i,i+9)=='Do While ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Do While </span>";i+=8;tabOrder++;
		}else if(!string && !comment && olddata[i]=='D' && i+3<olddata.length && olddata.substring(i,i+3)=='Do ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Do </span>";i+=2;tabOrder++;
		}else if(!string && !comment && olddata[i]=='S' && i+12<olddata.length && olddata.substring(i,i+12)=='Select Case ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Select Case </span>";i+=11;tabOrder+=2;
		}else if(!string && !comment && olddata[i]=='C' && i+3<olddata.length && olddata.substring(i,i+3)=='Chr' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Chr</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='E' && i+4<olddata.length && olddata.substring(i,i+4)=='Err.' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Err</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='R' && i+7<olddata.length && olddata.substring(i,i+7)=='Replace' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Replace</span>";i+=6;
		}else if(!string && !comment && olddata[i]=='T' && i+4<olddata.length && olddata.substring(i,i+4)=='True' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>True</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='F' && i+5<olddata.length && olddata.substring(i,i+5)=='False' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>False</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='D' && i+5<olddata.length && olddata.substring(i,i+5)=='Debug' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Debug</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='P' && i+6<olddata.length && olddata.substring(i,i+6)=='Print ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Print </span>";i+=5;
		}else if(!string && !comment && olddata[i]=='O' && i+9<olddata.length && olddata.substring(i,i+9)=='Optional ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Optional </span>";i+=8;
		}else if(!string && !comment && olddata[i]=='M' && i+7<olddata.length && olddata.substring(i,i+7)=='MsgBox ' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>MsgBox </span>";i+=6;
		}else if(!string && !comment && olddata[i]=='M' && i+5<olddata.length && olddata.substring(i,i+5)=='MkDir' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>MkDir</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='D' && i+3<olddata.length && olddata.substring(i,i+3)=='Dir' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Dir</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='L' && i+3<olddata.length && olddata.substring(i,i+3)=='Len' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Len</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='M' && i+3<olddata.length && olddata.substring(i,i+3)=='Mid' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Mid</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='I' && i+3<olddata.length && olddata.substring(i,i+3)=='IIf' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>IIf</span>";i+=2;
		}else if(!string && !comment && olddata[i]=='L' && i+4<olddata.length && olddata.substring(i,i+4)=='Left' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Left</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='R' && i+5<olddata.length && olddata.substring(i,i+5)=='Right' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#0FF'>Right</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='I' && i+7<olddata.length && olddata.substring(i,i+7)=='Integer' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Integer</span>";i+=6;
		}else if(!string && !comment && olddata[i]=='S' && i+6<olddata.length && olddata.substring(i,i+6)=='String' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>String</span>";i+=5;
		}else if(!string && !comment && olddata[i]=='B' && i+4<olddata.length && olddata.substring(i,i+4)=='Byte' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Byte</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='B' && i+7<olddata.length && olddata.substring(i,i+7)=='Boolean' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Boolean</span>";i+=6;
		}else if(!string && !comment && olddata[i]=='L' && i+4<olddata.length && olddata.substring(i,i+4)=='Long' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Long</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='D' && i+6<olddata.length && olddata.substring(i,i+6)=='Double' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Double</span>";i+=5;
		}else if(!string && !comment && olddata[i]=='S' && i+5<olddata.length && olddata.substring(i,i+5)=='Short' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Short</span>";i+=4;
		}else if(!string && !comment && olddata[i]=='O' && i+6<olddata.length && olddata.substring(i,i+6)=='Object' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Object</span>";i+=5;
		}else if(!string && !comment && olddata[i]=='V' && i+7<olddata.length && olddata.substring(i,i+7)=='Variant' && !prefixOperatorAccepted[olddata[i-1]]){
			newdata+="<span style='color:#099'>Variant</span>";i+=6;
		}else if(!string && !comment && olddata[i]==':' && i+2<olddata.length && olddata.substring(i,i+2)==':='){
			newdata+="<span style='color:#57C'>:=</span>";i++;
		}else if(!string && !comment && olddata[i]=='&' && i+8<olddata.length && olddata.substring(i,i+8)=='&lt;&gt;'){
			newdata+="<span style='color:#57C'>&nbsp;&lt;&gt;&nbsp;</span>";i+=7;
		}else if(!string && !comment && olddata[i]=='&' && i+4<olddata.length && olddata.substring(i,i+4)=='&lt;'){
			newdata+="<span style='color:#57C'>&nbsp;&lt;&nbsp;</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='&' && i+4<olddata.length && olddata.substring(i,i+4)=='&gt;'){
			newdata+="<span style='color:#57C'>&nbsp;&gt;&nbsp;</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='"' && i+4<olddata.length && olddata.substring(i,i+4)=='""""'){
			newdata+="<span style='color:#FFF'>\"\"\"\"</span>";i+=3;
		}else if(!string && !comment && olddata[i]=='&' && i+5<olddata.length && olddata.substring(i,i+5)=='&amp;'){
			if(!isNaN(olddata[i-1])&&olddata[i-1]!=' '){
				newdata+="<span style='color:#57C'>&amp;&nbsp;</span>"; //used as a pointer
			}else{
				newdata+="<span style='color:#57C'>&nbsp;&amp;&nbsp;</span>"; //used as concatentation
			} //end if
			if(i-length>100){
				length=i;
				newdata+="<span style='color:#F00'>_</span><br/>";
				for(j=0;j<=tabOrder;j++){
					newdata+='&nbsp;&nbsp;&nbsp;&nbsp;'; //4 space tabs
				} //end for
			} //end if
			i+=4;
		}else if(!string && !comment && olddata[i]=='('){
			newdata+="<span style='color:#57C'>(</span>";
		}else if(!string && !comment && olddata[i]==')'){
			newdata+="<span style='color:#57C'>)</span>";
		}else if(!string && !comment && olddata[i]=='*'){
			newdata+="<span style='color:#57C'> * </span>";
		}else if(!string && !comment && olddata[i]=='-'){
			newdata+="<span style='color:#57C'> - </span>";
		}else if(!string && !comment && olddata[i]=='+'){
			newdata+="<span style='color:#57C'> + </span>";
		}else if(!string && !comment && olddata[i]=='.'){
			newdata+="<span style='color:#57C'>.</span>";dotOperator=true;
		}else if(!string && !comment && olddata[i]=='['){
			newdata+="<span style='color:#57C'> [ </span>";
		}else if(!string && !comment && olddata[i]==']'){
			newdata+="<span style='color:#57C'> ] </span>";
		}else if(!string && !comment && olddata[i]=='!'){
			newdata+="<span style='color:#57C'>!</span>";
		}else if(!string && !comment && olddata[i]=='/'){
			newdata+="<span style='color:#57C'> / </span>";
		}else if(!string && !comment && olddata[i]=='='){
			newdata+="<span style='color:#57C'> = </span>";
		}else if(!string && !comment && olddata[i]==','){
			newdata+="<span style='color:#57C'>, </span>";
			if(i-length>100){
				length=i;
				newdata+="<span style='color:#F00'>_</span><br/>";
				for(j=0;j<=tabOrder;j++){
					newdata+='&nbsp;&nbsp;&nbsp;&nbsp;'; //4 space tabs
				}
			}
		}else if(!string && !comment && olddata[i]=="'"){
			comment=true;then=false;
			newdata+="<span style='color:#0F0'>'";
		}else if(!comment && olddata[i]=='"'){
			string^=1;
			if(string){
				newdata+="<span style='color:#396'> \"";
			}else{
				newdata+="\" </span>";
			} //end if
		}else if(!string && !comment && isNumber[olddata[i]]){
			if(notNumber||isLetter[olddata[i-1]]){ //number is a suffix of a variable name, don't highlight it
				notNumber=true;
				newdata+=olddata[i];
			}else{
				newdata+="<span style='color:#F80'>"+olddata[i]+"</span>";
			} //end if
		}else{
			newdata+=olddata[i];
			if(then){tabOrder--;then=false;}
		}
	}
	var result=document.getElementById('result');
	result.innerHTML=newdata;
	contentArea.style.visibility='hidden';
	result.style.visibility='visible';
};
</script></body></html>